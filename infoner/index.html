<!DOCTYPE html>
<html lang="ky">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="infoner.css">
  <title>Infoner</title>
  
</head>

<body>
  <h1 id="page-title">üìö Infoner –º–∞–∞–ª—ã–º–∞—Ç—Ç–∞—Ä—ã</h1>
  <div id="data-container">–ñ“Ø–∫—Ç”©–ª“Ø“Ø–¥”©...</div>
  
  <div id="single-post">
    <h2 id="single-title">–¢–µ–º–∞</h2>
    <p id="single-date">–î–∞—Ç–∞</p>
    <p id="single-content">–ú–∞–∑–º—É–Ω—É...</p>
    <br>
    <button class="btn" onclick="goBack()">‚¨Ö –ê—Ä—Ç–∫–∞ –∫–∞–π—Ç—É—É</button>
  </div>
  
  <script>
    const apiURL = "https://api.sheety.co/1d026645e5c7d5ee59c3c66286aef3c9/infoner/info";
    const urlParams = new URLSearchParams(window.location.search);
    const code = urlParams.get("code");
    
    const dataContainer = document.getElementById("data-container");
    const singlePost = document.getElementById("single-post");
    const titleEl = document.getElementById("single-title");
    const dateEl = document.getElementById("single-date");
    const contentEl = document.getElementById("single-content");
    const pageTitle = document.getElementById("page-title");
    
    fetch(apiURL)
      .then(response => response.json())
      .then(data => {
        const items = data.info;
        
        if (code) {
          // –ë–∏—Ä —Ç–µ–º–∞–Ω—ã –∫”©—Ä—Å”©—Ç“Ø“Ø
          const selected = items.find(item => item.id == code);
          if (selected) {
            dataContainer.style.display = "none";
            singlePost.style.display = "block";
            
            titleEl.innerText = selected.title;
            dateEl.innerText = "–ñ–∞—Ä—ã—è–ª–∞–Ω–≥–∞–Ω –¥–∞—Ç–∞: " + (selected.dateOfPublication || "–±–µ–ª–≥–∏—Å–∏–∑");
            contentEl.innerText = selected.content || "–ú–∞–∑–º—É–Ω —Ç–∞–±—ã–ª–≥–∞–Ω –∂–æ–∫.";
            
            document.title = selected.title;
            pageTitle.innerText = selected.title;
          } else {
            singlePost.innerHTML = "<p>–¢–µ–º–∞ —Ç–∞–±—ã–ª–≥–∞–Ω –∂–æ–∫.</p>";
          }
        } else {
          // –ë–∞—Ä–¥—ã–∫ —Ç–µ–º–∞–ª–∞—Ä–¥—ã –∫”©—Ä—Å”©—Ç“Ø“Ø
          dataContainer.innerHTML = "";
          
          items.forEach(item => {
            const div = document.createElement("div");
            div.className = "card";
            div.innerHTML = `
              <div class="title">üìå ${item.title}</div>
              <div class="date">üóì ${item.dateOfPublication || "–±–µ–ª–≥–∏—Å–∏–∑"}</div>
              <button class="btn" onclick="window.location.href='?code=${item.id}'">–û–∫—É—É</button>
            `;
            dataContainer.appendChild(div);
          });
        }
      })
      .catch(error => {
        dataContainer.innerHTML = "–ö–∞—Ç–∞ —á—ã–∫—Ç—ã: " + error.message;
      });
    
    function goBack() {
      window.location.href = "index.html";
    }
  </script>
</body>

</html>
